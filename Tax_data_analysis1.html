<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zahid Asghar, School of Economics, QAU, Islamabad">
<meta name="dcterms.date" content="2022-09-23">

<title>Tax collection data forecasting for next 12 months</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Tax_data_analysis1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Tax_data_analysis1_files/libs/quarto-html/quarto.js"></script>
<script src="Tax_data_analysis1_files/libs/quarto-html/popper.min.js"></script>
<script src="Tax_data_analysis1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Tax_data_analysis1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Tax_data_analysis1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Tax_data_analysis1_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Tax_data_analysis1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Tax_data_analysis1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Tax_data_analysis1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#analysis-objective" id="toc-analysis-objective" class="nav-link active" data-scroll-target="#analysis-objective"><strong>1.Analysis objective</strong></a></li>
  <li><a href="#models-used-explanation" id="toc-models-used-explanation" class="nav-link" data-scroll-target="#models-used-explanation"><strong>2. Models used: explanation</strong></a>
  <ul class="collapse">
  <li><a href="#analysis-outline" id="toc-analysis-outline" class="nav-link" data-scroll-target="#analysis-outline">2.1 Analysis outline</a></li>
  <li><a href="#package-uploaded-for-this-analysis" id="toc-package-uploaded-for-this-analysis" class="nav-link" data-scroll-target="#package-uploaded-for-this-analysis">2.2 Package uploaded for this analysis</a></li>
  <li><a href="#upload-data" id="toc-upload-data" class="nav-link" data-scroll-target="#upload-data">2.3 Upload data</a></li>
  <li><a href="#time-plot" id="toc-time-plot" class="nav-link" data-scroll-target="#time-plot">2.4 Time Plot</a></li>
  <li><a href="#multiple-line-plot" id="toc-multiple-line-plot" class="nav-link" data-scroll-target="#multiple-line-plot">2.5 Multiple line plot</a></li>
  <li><a href="#another-approach-for-multiple-line-chart" id="toc-another-approach-for-multiple-line-chart" class="nav-link" data-scroll-target="#another-approach-for-multiple-line-chart">2.5 Another approach for multiple line chart</a></li>
  </ul></li>
  <li><a href="#preliminary-data-decomposition" id="toc-preliminary-data-decomposition" class="nav-link" data-scroll-target="#preliminary-data-decomposition"><strong>3 Preliminary data decomposition</strong></a>
  <ul class="collapse">
  <li><a href="#why-we-investigate-stationarity-unit-root-test" id="toc-why-we-investigate-stationarity-unit-root-test" class="nav-link" data-scroll-target="#why-we-investigate-stationarity-unit-root-test">3.1 Why we investigate Stationarity? (unit root test)</a></li>
  <li><a href="#what-problems-are-caused-by-non-stationary-trend" id="toc-what-problems-are-caused-by-non-stationary-trend" class="nav-link" data-scroll-target="#what-problems-are-caused-by-non-stationary-trend">3.2 What problems are caused by non-stationary (trend)</a></li>
  <li><a href="#why-we-investigate-autocorrelation" id="toc-why-we-investigate-autocorrelation" class="nav-link" data-scroll-target="#why-we-investigate-autocorrelation">3.4 Why we investigate autocorrelation?</a></li>
  <li><a href="#seasonality" id="toc-seasonality" class="nav-link" data-scroll-target="#seasonality">3.6 Seasonality</a></li>
  </ul></li>
  <li><a href="#fit-a-model" id="toc-fit-a-model" class="nav-link" data-scroll-target="#fit-a-model"><strong>4. Fit a Model</strong></a>
  <ul class="collapse">
  <li><a href="#fit-ets-method-exponential-smoothing-method" id="toc-fit-ets-method-exponential-smoothing-method" class="nav-link" data-scroll-target="#fit-ets-method-exponential-smoothing-method">4.2 Fit ETS method, exponential smoothing method</a></li>
  <li><a href="#fit-on-arima-model" id="toc-fit-on-arima-model" class="nav-link" data-scroll-target="#fit-on-arima-model">4.3 Fit on ARIMA model</a></li>
  <li><a href="#neural-network-models" id="toc-neural-network-models" class="nav-link" data-scroll-target="#neural-network-models">4.4 Neural network models</a></li>
  </ul></li>
  <li><a href="#comparative-forecast-performance" id="toc-comparative-forecast-performance" class="nav-link" data-scroll-target="#comparative-forecast-performance">4.5 Comparative forecast performance</a>
  <ul class="collapse">
  <li><a href="#forecast-using-ann-model" id="toc-forecast-using-ann-model" class="nav-link" data-scroll-target="#forecast-using-ann-model"><strong>4.4 Forecast Using ANN model</strong></a></li>
  <li><a href="#forecast-using-arima-model" id="toc-forecast-using-arima-model" class="nav-link" data-scroll-target="#forecast-using-arima-model">Forecast Using ARIMA model</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Tax collection data forecasting for next 12 months</strong></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><em>Zahid Asghar, School of Economics, QAU, Islamabad</em> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="analysis-objective" class="level1">
<h1><strong>1.Analysis objective</strong></h1>
<p>This analysis has an objective to forecast revenue collection for the next 12 month from the last available data in 2021. Based on monthly Pakistan Tax Collection data, these time series cumulate from 2001 to the latest 2020 available data. __ This is still under development and in detail video on how to make this analysis and creating a file like this one will be uploade on <a href="https://www.youtube.com/channel/UCuzWrGHl5SNAau1RGxaXbUA">Data analysis and econometric</a></p>
<p>Main purpose of this analysis is to develop a tutorial for students who use time series modeling for forecasting. However, FBR officials can also use this analysis for forecasting and develop scenario for themselves. Our time series is a conventional univariate time series with date and monthly tax variables which we will list in the following chunk. The step applied in this analysis can be used in any forecast analysis.</p>
</section>
<section id="models-used-explanation" class="level1">
<h1><strong>2. Models used: explanation</strong></h1>
<p>This analysis is statistical forecasting (not economic forecasting) based on three classic forecasting models(Seasonal naïve, Exponential smoothing, ARIMA) and experienced one neural network model Seasonal naïve model.</p>
<p>I will start from very basics and will increase complexity gradually. Let me explain each model briefly.</p>
<p>As it will be observed in the following graphs that data have strong seasonality. Therefore, the first more basics models applied is the Seasonal Naive model. The seasonal naive model makes the forecast using the last value from the same season, for example, the year before to forecast the value for the next year.</p>
<p><strong>The second model</strong> applied is the exponentials state smoothing method by using ETS model who refer to error, trend and seasonality. This model can perform better in a short-term and on a univariate time series forecast. The model uses the exponentially weighted moving average (EWMA) to “smooth” a time series and trying to eliminate the random effect. The model uses a smoothing constant (a) which is transformed into a damping factor (1-a), the constant (a) define the weight which is applied to each period. ETS model can be applied as additive or multiplicative, but R selects the most optimal.</p>
<p><strong>The third model</strong> applied is the autoregressive integrated moving average (ARIMA). ARIMA models are more complex model than the two previous models mainly because of the algorithm which backed this forecast model in R. ARIMA is the combination of two models. First, autoregressive model AR(p), which forecast the variable of interest using a linear combination of past values of the variable, where (p) is the lag number. Second, moving average models MA(q), which is applied as a linear regression of the current value of the series against current and previous white noise error terms or random shocks.</p>
<p><strong>The fourth model</strong> applied, are neural network models (NN), which is the most complex model used in this analysis. This NN model performs in nonlinear time series and with big data sets. Because there seems nonlinearity in our data, we decided to test the predictive capacity of this model. The NN model is organised in multiples layers, the simplest networks contain no hidden layers and are equivalent to linear regressions. The coefficients attached to these predictors are called “weights”. The forecasts are obtained by a linear combination of the inputs. The weights are selected in the neural network framework by using a “learning algorithm”.</p>
<section id="analysis-outline" class="level2">
<h2 class="anchored" data-anchor-id="analysis-outline">2.1 Analysis outline</h2>
<p>First we upload data from the relevant working directory. How R and R Studio can be installed and data can be uploaded, watch <a href="https://youtu.be/ZNBZevfYgo0">R &amp;R Studio</a> and <a href="https://youtu.be/tgS-4RAC8aE">Data upload</a></p>
<p><a href="https://youtu.be/SRSNdCZ_QnE">Install R packages</a>, load the data and declare this data series as a time series. Preliminary data observations</p>
<p>Data decomposition: Stationarity and identify lag specification, Seasonal component, Cycle component, Trend component.</p>
<p>Finding the most accurate model 4.1. Seasonal Naive method 4.2. ETS method, exponential smouthing models 4.3. ARIMA model 4.4. Neural network model Make the forecast for the next 12 months. Conclusion Create a report with Markdown</p>
</section>
<section id="package-uploaded-for-this-analysis" class="level2">
<h2 class="anchored" data-anchor-id="package-uploaded-for-this-analysis">2.2 Package uploaded for this analysis</h2>
<p>Some of these packages are not required for this analysis.</p>
<div class="cell" data-eacho="false">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="upload-data" class="level2">
<h2 class="anchored" data-anchor-id="upload-data">2.3 Upload data</h2>
<p>This data is about monthly tax collection in billion of rupees (data source FBR).I have uploaded data from the respective directory.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tax_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Tax_billion_rs.xlsx"</span>) <span class="co">#Source FBR </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tax_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 223 × 7
   Date                  tax direct indirect sales excise custom
   &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 2001-12-01 00:00:00  39     20.6     18.3  13.6    3.3    1.4
 2 2002-01-01 00:00:00  32.8   13.4     19.4  12.6    3.4    3.4
 3 2002-02-01 00:00:00  27.6    7.5     20.1  13.2    3.7    3.2
 4 2002-03-01 00:00:00  34.9   12.5     22.4  14.1    3.9    4.4
 5 2002-04-01 00:00:00  36.3   12.3     24    15.1    4.7    4.2
 6 2002-05-01 00:00:00  37.4   10.3     27.1  16.9    4.9    5.3
 7 2002-06-01 00:00:00  60.3   23.8     36.5  20.9    6.1    9.5
 8 2002-07-01 00:00:00  23.6    4.8     18.8  12.3    2.6    3.9
 9 2002-08-01 00:00:00  29.6    7       22.6  14.5    3.5    4.6
10 2002-09-01 00:00:00  37.2   11.8     25.4  16.9    3.6    4.9
# … with 213 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>taxes<span class="ot">&lt;-</span>tax_data <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(Date), </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(Date), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">day</span>(Date))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>taxes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 223 × 10
   Date                  tax direct indirect sales excise custom  year month
   &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2001-12-01 00:00:00  39     20.6     18.3  13.6    3.3    1.4  2001    12
 2 2002-01-01 00:00:00  32.8   13.4     19.4  12.6    3.4    3.4  2002     1
 3 2002-02-01 00:00:00  27.6    7.5     20.1  13.2    3.7    3.2  2002     2
 4 2002-03-01 00:00:00  34.9   12.5     22.4  14.1    3.9    4.4  2002     3
 5 2002-04-01 00:00:00  36.3   12.3     24    15.1    4.7    4.2  2002     4
 6 2002-05-01 00:00:00  37.4   10.3     27.1  16.9    4.9    5.3  2002     5
 7 2002-06-01 00:00:00  60.3   23.8     36.5  20.9    6.1    9.5  2002     6
 8 2002-07-01 00:00:00  23.6    4.8     18.8  12.3    2.6    3.9  2002     7
 9 2002-08-01 00:00:00  29.6    7       22.6  14.5    3.5    4.6  2002     8
10 2002-09-01 00:00:00  37.2   11.8     25.4  16.9    3.6    4.9  2002     9
# … with 213 more rows, and 1 more variable: day &lt;int&gt;
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##yearly data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tax_year<span class="ot">&lt;-</span>taxes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tax_yr=</span><span class="fu">sum</span>(tax),<span class="at">dir_yr=</span><span class="fu">sum</span>(direct),<span class="at">indir_yr=</span><span class="fu">sum</span>(indirect),<span class="at">sales_yr=</span><span class="fu">sum</span>(sales),<span class="at">excise_yr=</span><span class="fu">sum</span>(excise), <span class="at">custom_yr=</span><span class="fu">sum</span>(custom))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tax_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 7
    year tax_yr dir_yr indir_yr sales_yr excise_yr custom_yr
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  2001    39    20.6     18.3     13.6       3.3       1.4
 2  2002   431.  142.     289.     185        46.6      57.7
 3  2003   490.  160      330.     203.       44.7      81.8
 4  2004   551   174.     377.     228.       48.6     101. 
 5  2005   652.  209.     444.     263.       54.6     126. 
 6  2006   799.  292.     508.     307.       63.6     137. 
 7  2007   871   325.     546.     332.       80.3     133. 
 8  2008  1120   429.     691.     424.      105.      162. 
 9  2009  1185.  441.     744.     478       127.      139. 
10  2010  1414   561.     854.     560.      122.      171. 
11  2011  1737   674.    1063.     732.      133.      199. 
12  2012  1931.  764.    1167.     816.      121.      231. 
13  2013  2089.  788.    1301.     932.      127.      242. 
14  2014  2395.  954.    1441.    1028.      144.      268. 
15  2015  2803. 1115.    1687.    1165.      172.      350. 
16  2016  3199. 1242.    1957.    1310.      202.      445. 
17  2017  3617. 1416.    2201.    1438       203.      560. 
18  2018  3915. 1541.    2374.    1493.      218.      663. 
19  2019  4120. 1555.    2565.    1637.      252.      676. 
20  2020  1877.  719.    1158.     731.      130.      297. </code></pre>
</div>
</div>
</section>
<section id="time-plot" class="level2">
<h2 class="anchored" data-anchor-id="time-plot">2.4 Time Plot</h2>
<p>We have used “The Economist Themse”, one may use one’s own choice like <strong>Financil Times</strong>, <strong>Fivethirtyeight.com</strong> etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tax_data)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>tax)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Rs. in Billion"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Monthly tax collection year wise in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()<span class="do">## Plot total taxes with The Economist theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="multiple-line-plot" class="level2">
<h2 class="anchored" data-anchor-id="multiple-line-plot">2.5 Multiple line plot</h2>
<p>There are total taxes, direct and indirect taxes, and subcomponents of indirect taxes- sales tax, custom and excise duties. Now we plot direct and indirect taxes. How t</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tax_data, <span class="fu">aes</span>(<span class="at">x=</span>Date)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> direct), <span class="at">color =</span> <span class="st">"darkred"</span>) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> indirect), <span class="at">color=</span><span class="st">"steelblue"</span>, <span class="at">linetype=</span><span class="st">"twodash"</span>)<span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"darkred"</span>, <span class="st">"steelblue"</span>)) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Rs. in Billion"</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Monthly tax collection year wise in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()<span class="co">#Method 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="another-approach-for-multiple-line-chart" class="level2">
<h2 class="anchored" data-anchor-id="another-approach-for-multiple-line-chart">2.5 Another approach for multiple line chart</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> tax_data <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, tax, direct, indirect) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>Date)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 669 × 3
   Date                variable value
   &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt;
 1 2001-12-01 00:00:00 tax       39  
 2 2002-01-01 00:00:00 tax       32.8
 3 2002-02-01 00:00:00 tax       27.6
 4 2002-03-01 00:00:00 tax       34.9
 5 2002-04-01 00:00:00 tax       36.3
 6 2002-05-01 00:00:00 tax       37.4
 7 2002-06-01 00:00:00 tax       60.3
 8 2002-07-01 00:00:00 tax       23.6
 9 2002-08-01 00:00:00 tax       29.6
10 2002-09-01 00:00:00 tax       37.2
# … with 659 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable, <span class="at">linetype =</span> variable)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"darkred"</span>, <span class="st">"steelblue"</span>)) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Rs. in Billion"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Monthly tax collection year wise in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We observe a strong positive trend and seasonality. Trend over time seems bit nonlinear. Even though, in this first observation, we can intuitively conclude that these time series have no stationary. In the next section, we will investigate and identify those potential problems in the way to make some correction to this time series and for selecting the most appropriate forecasting model.</p>
</section>
</section>
<section id="preliminary-data-decomposition" class="level1">
<h1><strong>3 Preliminary data decomposition</strong></h1>
<section id="why-we-investigate-stationarity-unit-root-test" class="level2">
<h2 class="anchored" data-anchor-id="why-we-investigate-stationarity-unit-root-test">3.1 Why we investigate Stationarity? (unit root test)</h2>
<p>A time series is stationary if it’s characteristics like mean, variance, covariance, are time variant: that is, they do not change over the time. Non-stationarity may cause autocorrelation which we explained in the next step.</p>
<p>We will make the Dickey-Fuller Test to check the stationarity in the data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(tax_data<span class="sc">$</span>direct, <span class="at">alternative =</span> <span class="st">"stationary"</span>, <span class="at">k=</span><span class="dv">12</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  tax_data$direct
Dickey-Fuller = -2.2077, Lag order = 12, p-value = 0.4888
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Null hypothesis of non-stationarity is not rejected. This test confirmed that this series is not stationary.</p>
<p>To correct the non-stationarity problem, we apply the first difference and make the Dickey-Fuller again.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>DS <span class="ot">&lt;-</span> <span class="fu">diff</span>(tax_data<span class="sc">$</span>direct)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(DS, <span class="at">alternative =</span> <span class="st">"stationary"</span>, <span class="at">k=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(DS, alternative = "stationary", k = 12): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  DS
Dickey-Fuller = -6.1464, Lag order = 12, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>The Dickey-Fuller test allows you to reject the null hypothesis with this small p-value and we can conclude this series is stationary. By taking the first difference, we are making the making the corrections on this initial non-stationary time series.</p>
<p>We can visualize the data, for seeing the impact of the first difference on this time series.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DS<span class="ot">&lt;-</span>tax_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mom_pct=</span>(direct<span class="sc">/</span><span class="fu">lag</span>(direct)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DS)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>mom_pct)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Month on month basis changes in tax collection"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We will take the first difference from the data to remove the trend. With this first difference, we can work with this time series without having the trend influence forecasting .</p>
</section>
<section id="what-problems-are-caused-by-non-stationary-trend" class="level2">
<h2 class="anchored" data-anchor-id="what-problems-are-caused-by-non-stationary-trend">3.2 What problems are caused by non-stationary (trend)</h2>
<p>Also, It’s important because it helps to identify the driving factors. When we detect a change in a time series, we may be able to infer a correlation. But we need both time series to be stationary (no trend and no seasonality); otherwise, the correlation we find will be misleading.</p>
<p>There are three main problems with stochastic trends: 1. AR coefficients can be badly biased towards zero. This means that if you estimate an AR and make forecasts, if there is a unit root then your forecasts can be poor (AR coefficients biased towards zero)</p>
<pre><code>2.  Some t-statistics don’t have a standard normal distribution, even in large samples (more on this later)

3.  If Y and X both have random walk trends then they can look related even if they are not – you can get “spurious regressions.”</code></pre>
</section>
<section id="why-we-investigate-autocorrelation" class="level2">
<h2 class="anchored" data-anchor-id="why-we-investigate-autocorrelation">3.4 Why we investigate autocorrelation?</h2>
<p>Autocorrelation means that there are correlations in the error or lag correlations of a given series with itself, lagged by a number of time units. Which signify:</p>
<p><span class="math display">\[Y_c =x + \beta X_i+u_i\]</span></p>
<p><span class="math display">\[Cov(u_i, u_s) \neq 0 \forall  i\neq s\]</span></p>
<p>Autocorrelation measures the linear relationship between lagged values of a time series. We will see dependence in the data across a range of lag value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(tax_data<span class="sc">$</span>direct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>acf plot shows that the data are strongly non-random and autorgressive model maybe appropriate. We can check the autocorrelation by plotting residual and standardized residuals of regression against time and compare if they show a similar pattern which signs for autocorrelation.</p>
</section>
<section id="seasonality" class="level2">
<h2 class="anchored" data-anchor-id="seasonality">3.6 Seasonality</h2>
<p>Seasonality is a pattern which occurs when a time series is observed at less than annual frequency and is affected by seasonal factors such as the time of the year or the day of the week. We know that tax collection authorities usually have to meet quarterly target and some accounting lags also make collection a seasonal phenomena. We need to detect seasonality in a time series in the way to make the necessary adjustment or for choosing the appropriate models. Seasonality adjustment has three main reasons: 1. to aid in short-term forecasting<br>
2. to help in relating time series to other series or extreme events 3. to allow series to be compared from year to year or month to month or the day today.</p>
<p>Following two visualizations will help to identify the seasonality.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ts_tax<span class="ot">&lt;-</span><span class="fu">ts</span>(DS<span class="sc">$</span>mom_pct,  <span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">1</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>decomp<span class="ot">&lt;-</span><span class="fu">decompose</span>(ts_tax)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggseasonplot</span>(ts_tax,<span class="at">year.labels=</span><span class="cn">TRUE</span>, <span class="at">year.labels.left=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Rs. in Billion"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Monthly tax collection year wise in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe that those 19 multiples colour lines, already have the same pattern over the years. Those colour lines informed you of the possible presence of seasonal cycles in this time series.</p>
<p>Now, look at this other seasonal plot which isolates the variation for one month at the time</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsubseriesplot</span>(ts_tax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 19 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The horizontal lines indicate the means for each month. This form of plot enables the underlying seasonal pattern to be seen clearly, and also shows the changes in seasonality over time. It is especially useful in identifying changes within particular seasons.</p>
<p>Both line and seasonal plots indicate that there seems strong trend and seasonality pattern in tax data.</p>
</section>
</section>
<section id="fit-a-model" class="level1">
<h1><strong>4. Fit a Model</strong></h1>
<p>In this section we are going to fit a model on tax data and will find out the most appropriate model. ## 4.1 seasonal naïve method as our benchmark</p>
<p>This model is used as a benchmark and performance of any technical model is compared with this model. This model using the most recent observation as a forecast. We are using seasonal naive model because data seems seasonal.</p>
<p><span class="math display">\[\hat{y}_{T+h|T}=y_{T+h-m(k+1)}\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fit_SN <span class="ot">&lt;-</span> <span class="fu">snaive</span>(ts_tax)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> forecast<span class="sc">::</span><span class="fu">snaive</span>((ts_tax), <span class="at">h =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast      Lo 80      Hi 80       Lo 95     Hi 95
Aug 2019     -61.781323 -116.64006  -6.922584 -145.680524  22.11788
Sep 2019      -8.219178  -63.07792  46.639561  -92.118380  75.68002
Oct 2019      87.734842   32.87610 142.593581    3.835640 171.63404
Nov 2019     -36.228657  -91.08740  18.630082 -120.127859  47.67054
Dec 2019      -2.371917  -57.23066  52.486823  -86.271118  81.52728
Jan 2020     120.991254   66.13251 175.849993   37.092052 204.89046
Feb 2020     -50.483729 -105.34247   4.375010 -134.382931  33.41547
Mar 2020     -10.834813  -65.69355  44.023926  -94.734015  73.06439
Apr 2020      36.553785  -18.30495  91.412524  -47.345417 120.45299
May 2020     -39.815463  -94.67420  15.043276 -123.714665  44.08374
Jun 2020      -3.664877  -58.52362  51.193862  -87.564079  80.23432
Jul 2020     160.519066  105.66033 215.377805   76.619864 244.41827
Aug 2020     -61.781323 -139.36330  15.800650 -180.432712  56.87007
Sep 2020      -8.219178  -85.80115  69.362795 -126.870567 110.43221
Oct 2020      87.734842   10.15287 165.316815  -30.916547 206.38623
Nov 2020     -36.228657 -113.81063  41.353316 -154.880046  82.42273
Dec 2020      -2.371917  -79.95389  75.210056 -121.023305 116.27947
Jan 2021     120.991254   43.40928 198.573227    2.339865 239.64264
Feb 2021     -50.483729 -128.06570  27.098244 -169.135118  68.16766
Mar 2021     -10.834813  -88.41679  66.747159 -129.486202 107.81658
Apr 2021      36.553785  -41.02819 114.135758  -82.097604 155.20517
May 2021     -39.815463 -117.39744  37.766510 -158.466852  78.83593
Jun 2021      -3.664877  -81.24685  73.917096 -122.316266 114.98651
Jul 2021     160.519066   82.93709 238.101038   41.867677 279.17045</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_SN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Seasonal naive method
Q* = 78.066, df = 24, p-value = 1.233e-07

Model df: 0.   Total lags used: 24</code></pre>
</div>
</div>
<p>We have Residual sd: 42.8065 from summary(fit_SN) command. The acf graph of residuals indicate autocorrelation among the residuals. Ljung Box statistics is also very high and it reject the null hypothesis that residuals are uncorrelated.</p>
<p>The naive and Snaive model are fundamental models. Some business uses those model basic forecasting models, maybe because of the lack of internal resources. Producing or maintaining extra stock it is a cost for the company and creates inefficiency. We continue testing the forecast performance of others models.</p>
<section id="fit-ets-method-exponential-smoothing-method" class="level2">
<h2 class="anchored" data-anchor-id="fit-ets-method-exponential-smoothing-method">4.2 Fit ETS method, exponential smoothing method</h2>
<p>Second, we will apply ETS model: Error, Trend, Seasonal. The flexibility of the ETS model lies in its ability to trend and seasonal components of different traits. This function ets() automatically optimizes the choice of model and necessary parameters. We present the structure of the additive and the multiplicative form.</p>
<p>Assuming: <span class="math display">\[\mu_t = \hat{y}_t=l_{t-1}+ b_{t-1}\]</span> and</p>
<p><span class="math display">\[\varepsilon_t = y_{t} - \mu_{t}\]</span></p>
<p>ETS additive</p>
<p><span class="math display">\[y_t =  l_{t-1} + \phi b_{t-1} + \varepsilon_t\]</span></p>
<p><span class="math display">\[l_t =  l_{t-1} + \phi b_{t-1} + \alpha\varepsilon_t\]</span></p>
<p><span class="math display">\[b_t =  \phi b_{t-1} + \beta^*(l_{t}-l_{t-1}- \phi b_{t-1} = \phi b_{t-1}+\alpha\beta^*\varepsilon_t\]</span></p>
<p><span class="math display">\[\varepsilon_t = (y_t-\mu_t ) / \mu_t\]</span></p>
<p><span class="math display">\[y_t =  (l_{t-1} + \phi b_{t-1}) (1+\varepsilon_t)\]</span></p>
<p><span class="math display">\[l_t =  (l_{t-1} + \phi b_{t-1}) (1+\alpha\varepsilon_t)\]</span></p>
<p><span class="math display">\[b_t = \phi b_{t-1}+\beta(l_{t-1} + \phi b_{t-1})\varepsilon_t\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fit_ets <span class="ot">&lt;-</span> <span class="fu">ets</span>(ts_tax) <span class="co">#residual = 221.1631</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(ts_tax): Missing values encountered. Using longest contiguous
portion of time series</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_ets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ETS(A,N,A)
Q* = 96.146, df = 10, p-value = 3.331e-16

Model df: 14.   Total lags used: 24</code></pre>
</div>
</div>
<p>We have a residual sd =40.49 from summary(fit_ets) command, which are more accurate than the seasonal naïve models and what mean for the exact month the years before, which missing on average 40.49 billion.</p>
<p>So this model increases the precision and offer a better fit but: if we look to AFC graph, we observe that there remains autocorrelation because of the bar going out of the 95% confidence line.</p>
<p>The Ljung-Box test Test results also indicate rejection of null hypothesis that residuals are non-correlated.</p>
<p>We realize that with using just a bit more complex forecasting model, we increase accuracy and can make a significant improvement in tax collection. We continue our analysis with a one of the most performant forecasting model the ARIMA.</p>
</section>
<section id="fit-on-arima-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-on-arima-model">4.3 Fit on ARIMA model</h2>
<p>ARIMA model is a Generalized random walk model which is fine-tuned to eliminate all residual autocorrelation. It is a Generalized exponential smoothing model that can incorporate long-term trends and seasonality.</p>
<p>AR(p) model</p>
<p><span class="math display">\[(1-\sum^p_{k=1}\alpha_kL^k)X_t = \varepsilon_t\]</span></p>
<p>MA(q) model <span class="math inline">\(X_t = (1+\sum^q_{k=1}\beta_kL^k)\varepsilon_t\)</span> First difference is <span class="math inline">\(\Delta X_t=X_t -X_{t-1} = (1-L)X_t\)</span> where <span class="math inline">\(\ Y_t = (1-L)X_t\)</span></p>
<p>ARIMA(p, d, q) full model</p>
<p><span class="math display">\[(1-\sum^p_{k=1}\alpha_kL^k)(1-L)^dX_t = (1+\sum^q_{k=1}\beta_kL^k)\varepsilon_t\]</span></p>
<p>ARIMAX model</p>
<p><span class="math display">\[\Delta y_t=\alpha_0+\sum_{j}\alpha_j \Delta y_{t-j}+\sum_h\gamma_h\epsilon_{t-h}+X\beta+\epsilon_t\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit_ARIMA &lt;- auto.arima(ts_tax, d=1,D=1, stepwise = FALSE, approximation = FALSE)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#checkresiduals(fit_ARIMA)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We have a residual standard error (residual) = sqrt(1251), what mean for the exact month the years before, which missing on average 35 billion.</p>
<p>At this stage, we can conclude that the ARIMA model offers the best fit base on residual and standard deviations.</p>
<p>The Ljung-Box test Test results also indicate that model is appropriate fit as null hypothesis of non-autocorrelation among residuals is rejected. So far ARIMA model not only passes the diagnostic testing but also performs better than the seasonal naive and ETS models.</p>
<p>Though for economic theory or behavioral models, simpler the better. But for forecasting having capacity for applying and Understanding complex models is a plus value for any business or forecasting team. Many decisions are based on the capacity to forecast revenues. Accuracy in short-term revenue forecast has the critical impact on all economic planning. Accuracy on long-term forecasting, contribute for supporting the significant fiscal decision. In the end, short-term and long-term forecast accuracy will have a significant impact to optimize the growth of the economy. Lousy forecasting can reduce FBR capacity for effecient decision making.</p>
</section>
<section id="neural-network-models" class="level2">
<h2 class="anchored" data-anchor-id="neural-network-models">4.4 Neural network models</h2>
<p>This model allows complex nonlinear relationships between the response variable and its predictors. Our time series are mostly linear, and in this case, the neural network may not be the most appropriate model, but we will compare performance against seasonal naive, ETS and ARIMA.</p>
<p>In neural network the inputs of each node are combined using a weighted linear combination. For exemple, the inputs (for 4 inputs) into hidden neuron j are combined linearly to give</p>
<p><span class="math display">\[z_j = b_j+\sum_{i=1}^4 w_i,_jx_i\]</span></p>
<p>and in the hidden layer,this is then modified using a nonlinear function such as a sigmoid,</p>
<p><span class="math display">\[s(z) = \frac{1}{1=e^-z}\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>NNL <span class="ot">&lt;-</span> <span class="fu">nnetar</span>(ts_tax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nnetar(ts_tax): Missing values in x, omitting rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nnetar</span>(ts_tax, <span class="at">lambda=</span><span class="st">"auto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nnetar(ts_tax, lambda = "auto"): Missing values in x, omitting rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
parameter (lambda) is given for strictly positive data.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(NNL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in modeldf.default(object): Could not find appropriate degrees of
freedom for this model.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(NN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   ME    RMSE      MAE  MPE MAPE      MASE       ACF1
Training set 3.466634 32.1801 18.74901 -Inf  Inf 0.7517102 -0.1806603</code></pre>
</div>
</div>
<p>There seems some spikes going out of usual range in acf plot of residuals which may indicate little problem of residuals autocorrelation. This is very complex model but often very useful for deep learning.</p>
</section>
</section>
<section id="comparative-forecast-performance" class="level1">
<h1>4.5 Comparative forecast performance</h1>
<p>We will compare those forecast models performances with using two strategies.</p>
<p>First strategy: We will compare the indicators produced by the output of the accuracy() function when all the time series is the training set.</p>
<p>Second strategy: Like the first strategy, we will compare the indexes produce by the output of the accuracy() function but we will split the dataset by creating, one training set and one test set.</p>
<p>It is important to use the right tool for an accurate analysis and for understanding the impact on the results when a different strategy is used.</p>
<p>We will base ours performance comparison model analysis on those indexes which will we define it before we use it.</p>
<p>Mean absolute error: MAE</p>
<p><span class="math display">\[MAE=mean(e^2_{t})\]</span></p>
<p>Root mean squared error: RMSE</p>
<p><span class="math display">\[e_{t}={y}_{t}-\hat{y}_{t|N}\]</span></p>
<p><span class="math display">\[RMSE=\sqrt{mean(e^2_{t})}\]</span></p>
<p>Mean absolute percentage error: MAPE</p>
<p><span class="math display">\[p_{t}=100e_{t}/y_{t}\]</span></p>
<p>Mean absolute scaled error : MASE</p>
<p><span class="math display">\[q_{t}= e_{t}/Q\]</span></p>
<p>Where Q is a scaling statistic computed on the training data.</p>
<p><span class="math display">\[p_{t}=100e_{t}/y_{t}\]</span></p>
<p>Autocorrelations of error at lag1 (ACF)</p>
<p><span class="math display">\[ACF=\frac{Covariance(x_{t},x_{t-h})}{Variance(x_{t})}\]</span></p>
<p>If we print summary of each model and compare accuracy, we observe that ARIMA model seems the best while NN model seems the second best. Therefore, now we forecast with NN and ARIMA models for 24 time periods ahead.</p>
<section id="forecast-using-ann-model" class="level2">
<h2 class="anchored" data-anchor-id="forecast-using-ann-model"><strong>4.4 Forecast Using ANN model</strong></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nnetar</span>(ts_tax, <span class="at">lambda=</span><span class="st">"auto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nnetar(ts_tax, lambda = "auto"): Missing values in x, omitting rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
parameter (lambda) is given for strictly positive data.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(NN, <span class="at">h=</span><span class="dv">24</span>, <span class="at">PI=</span><span class="cn">TRUE</span>, <span class="at">npaths=</span><span class="dv">100</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast2, <span class="at">include =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(fcast2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: NNAR(6,1,4)[12]

Model Information:

Average of 20 networks, each of which is
a 7-4-1 network with 37 weights
options were - linear output units 

Error measures:
                   ME     RMSE      MAE  MPE MAPE      MASE       ACF1
Training set 3.447207 32.36352 18.52546 -Inf  Inf 0.7427472 -0.1666907

Forecasts:
         Point Forecast      Lo 80        Hi 80       Lo 95       Hi 95
Aug 2019   -54.44112937 -158.33102 -19.52253661 -285.645576 -10.6294421
Sep 2019    -9.47689439  -30.83515   0.05779493  -70.745131   2.5975307
Oct 2019    77.35677044   31.42612 200.62946930    8.212923 341.9439005
Nov 2019   -43.16620066 -100.09083  -3.59345962 -192.027110  -0.2326238
Dec 2019    -0.52308080  -15.15367   2.44541148  -29.806597  15.1441404
Jan 2020   127.51166295   52.85333 295.56774706   29.089169 523.4007508
Feb 2020   -55.09513926 -152.56226 -10.93471846 -209.715093  -2.7060501
Mar 2020    -4.26538395  -31.77555   0.67142377  -55.745103  16.5771126
Apr 2020    53.05845519   28.39936 174.33620157    7.721526 219.9414961
May 2020   -43.56173495 -115.21334  -5.92561909 -196.136508  -0.2511888
Jun 2020    -0.03793468  -13.21522   2.82480052  -29.644094  23.3519219
Jul 2020   136.22362324   48.27500 299.36201556   21.406835 391.9632389
Aug 2020   -60.23208720 -143.58682 -13.63464134 -220.309514  -1.4177580
Sep 2020    -4.12958623  -13.62670   2.44255737  -59.904268  38.5653008
Oct 2020    76.21189565   23.92936 221.34195606    7.340957 285.6772641
Nov 2020   -47.71622508 -120.96744  -2.19131516 -191.928365   2.9844824
Dec 2020     0.01049086  -21.29164  14.85631455  -86.051695 114.0738246
Jan 2021   128.04117119   33.95979 277.39431545   16.686062 386.9917248
Feb 2021   -64.27329376 -149.05764  -8.54499731 -262.971904  -1.1778253
Mar 2021    -1.72870841  -21.64499  28.71225766  -50.182220 137.3700820
Apr 2021    75.39288789   29.66795 214.65077010    7.125741 327.9004125
May 2021   -48.93417175 -123.33977  -2.93220038 -167.941934   1.8967130
Jun 2021     0.75794564  -10.46581  20.19202528  -63.786945 120.3817774
Jul 2021   124.74956875   27.66990 212.92481578   11.459110 360.2269417</code></pre>
</div>
</div>
</section>
<section id="forecast-using-arima-model" class="level2">
<h2 class="anchored" data-anchor-id="forecast-using-arima-model">Forecast Using ARIMA model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit_ARIMA %&gt;% forecast(h=24) %&gt;% autoplot()</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#auto.arima(tax_data$direct) %&gt;% forecast(h=24) %&gt;% autoplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tax_year1<span class="ot">&lt;-</span>tax_year <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">!=</span><span class="st">"2001"</span><span class="sc">&amp;</span> year<span class="sc">!=</span><span class="st">"2020"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>tax_year1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 7
    year tax_yr dir_yr indir_yr sales_yr excise_yr custom_yr
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  2002   431.   142.     289.     185       46.6      57.7
 2  2003   490.   160      330.     203.      44.7      81.8
 3  2004   551    174.     377.     228.      48.6     101. 
 4  2005   652.   209.     444.     263.      54.6     126. 
 5  2006   799.   292.     508.     307.      63.6     137. 
 6  2007   871    325.     546.     332.      80.3     133. 
 7  2008  1120    429.     691.     424.     105.      162. 
 8  2009  1185.   441.     744.     478      127.      139. 
 9  2010  1414    561.     854.     560.     122.      171. 
10  2011  1737    674.    1063.     732.     133.      199. 
11  2012  1931.   764.    1167.     816.     121.      231. 
12  2013  2089.   788.    1301.     932.     127.      242. 
13  2014  2395.   954.    1441.    1028.     144.      268. 
14  2015  2803.  1115.    1687.    1165.     172.      350. 
15  2016  3199.  1242.    1957.    1310.     202.      445. 
16  2017  3617.  1416.    2201.    1438      203.      560. 
17  2018  3915.  1541.    2374.    1493.     218.      663. 
18  2019  4120.  1555.    2565.    1637.     252.      676. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tax_year1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>year)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> dir_yr), <span class="at">color =</span> <span class="st">"darkred"</span>) <span class="sc">+</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> indir_yr), <span class="at">color=</span><span class="st">"steelblue"</span>, <span class="at">linetype=</span><span class="st">"twodash"</span>)<span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"darkred"</span>, <span class="st">"steelblue"</span>)) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Rs. in Billion"</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Indirect (dashed) and direct taxes (solid line) in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>indirect_direct<span class="ot">&lt;-</span>tax_year <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ind_dir=</span>(indir_yr<span class="sc">/</span>dir_yr)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">!=</span><span class="dv">2001</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indirect_direct)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>ind_dir)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Ratio of indirect to direct taxes year wise in billion of Rs. by FBR"</span>)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">" Source :FBR"</span>)<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Tax_data_analysis1_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>