<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zahid Asghar">
<meta name="dcterms.date" content="2022-09-26">

<title>Tax Analysis for Services Sector in DUMMY_PROV</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="total-tax-output_files/libs/clipboard/clipboard.min.js"></script>
<script src="total-tax-output_files/libs/quarto-html/quarto.js"></script>
<script src="total-tax-output_files/libs/quarto-html/popper.min.js"></script>
<script src="total-tax-output_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="total-tax-output_files/libs/quarto-html/anchor.min.js"></script>
<link href="total-tax-output_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="total-tax-output_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="total-tax-output_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="total-tax-output_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="total-tax-output_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="total-tax-output_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="total-tax-output_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="total-tax-output_files/libs/datatables-binding-0.23/datatables.js"></script>
<script src="total-tax-output_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="total-tax-output_files/libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="total-tax-output_files/libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="total-tax-output_files/libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="total-tax-output_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="total-tax-output_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overall-tax" id="toc-overall-tax" class="nav-link active" data-scroll-target="#overall-tax">Overall Tax</a>
  <ul class="collapse">
  <li><a href="#overall-tax-summary" id="toc-overall-tax-summary" class="nav-link" data-scroll-target="#overall-tax-summary">Overall Tax Summary</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#monthly-tax-summary" id="toc-monthly-tax-summary" class="nav-link" data-scroll-target="#monthly-tax-summary">Monthly tax summary</a></li>
  <li><a href="#forecasting-overall-tax_output" id="toc-forecasting-overall-tax_output" class="nav-link" data-scroll-target="#forecasting-overall-tax_output">Forecasting overall tax_output</a></li>
  <li><a href="#annual-forecasting" id="toc-annual-forecasting" class="nav-link" data-scroll-target="#annual-forecasting">Annual Forecasting</a>
  <ul class="collapse">
  <li><a href="#naive-forecasting" id="toc-naive-forecasting" class="nav-link" data-scroll-target="#naive-forecasting">NAIVE Forecasting</a></li>
  <li><a href="#arima-models" id="toc-arima-models" class="nav-link" data-scroll-target="#arima-models">ARIMA models</a></li>
  <li><a href="#aritificial-nueral-networks" id="toc-aritificial-nueral-networks" class="nav-link" data-scroll-target="#aritificial-nueral-networks">Aritificial Nueral Networks</a></li>
  </ul></li>
  <li><a href="#monthly-forecasting-for-total-tax-over-time" id="toc-monthly-forecasting-for-total-tax-over-time" class="nav-link" data-scroll-target="#monthly-forecasting-for-total-tax-over-time">Monthly forecasting for total tax over time</a>
  <ul class="collapse">
  <li><a href="#autoregressive-integrated-moving-average-models" id="toc-autoregressive-integrated-moving-average-models" class="nav-link" data-scroll-target="#autoregressive-integrated-moving-average-models">Autoregressive Integrated Moving Average Models</a></li>
  <li><a href="#artificial-nueral-network-forecasting" id="toc-artificial-nueral-network-forecasting" class="nav-link" data-scroll-target="#artificial-nueral-network-forecasting">Artificial Nueral Network Forecasting</a></li>
  </ul></li>
  <li><a href="#service-sector-share-in-total-tax-by-service-category" id="toc-service-sector-share-in-total-tax-by-service-category" class="nav-link" data-scroll-target="#service-sector-share-in-total-tax-by-service-category">Service sector share in total tax by service category</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#top-15-sector-during-fy-2020-22-as-per-tax_output" id="toc-top-15-sector-during-fy-2020-22-as-per-tax_output" class="nav-link" data-scroll-target="#top-15-sector-during-fy-2020-22-as-per-tax_output">Top 15 sector during FY 2020-22 as per Tax_output</a></li>
  <li><a href="#forecasting-for-service-having-tax-rate-16" id="toc-forecasting-for-service-having-tax-rate-16" class="nav-link" data-scroll-target="#forecasting-for-service-having-tax-rate-16">Forecasting for Service having Tax rate 16%</a>
  <ul class="collapse">
  <li><a href="#tax-forecast-for-services-having-16-tax-rate" id="toc-tax-forecast-for-services-having-16-tax-rate" class="nav-link" data-scroll-target="#tax-forecast-for-services-having-16-tax-rate">Tax forecast for services having 16% tax-rate</a></li>
  </ul></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tax Analysis for Services Sector in DUMMY_PROV</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zahid Asghar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 26, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"D:/RepTemplates/Tax_data/Data.RData"</span>) <span class="do">## Data are loaded</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>tax<span class="ot">&lt;-</span>Data</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>tax<span class="sc">$</span>Date<span class="ot">&lt;-</span>lubridate<span class="sc">::</span><span class="fu">ym</span>(tax<span class="sc">$</span>TAX_PERIOD)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>tax<span class="sc">$</span>SCODE<span class="ot">&lt;-</span><span class="fu">as.character</span>(tax<span class="sc">$</span>SCODE)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,033,223
Columns: 27
$ `Tax Payer`                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2…
$ SCODE                         &lt;chr&gt; "9815.6", "9815.6", "9815.6", "9815.6", …
$ SERVICE                       &lt;chr&gt; "Information Technology-enabled or Infor…
$ TAX_PERIOD                    &lt;dbl&gt; 201907, 201908, 201909, 201910, 201911, …
$ Year                          &lt;dbl&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020…
$ PURCHASE_VALUE                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ PURCHASE_TAX                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ IMPORT_VALUE                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ IMPORT_TAX                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ NON_CREDITABLE_TAX            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ CARRY_FORWARD_PREVIOUS_MONTHS &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ SALES_TAX_WHT                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ INPUT_TAX                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ ACCUMULATED_CREDIT            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0…
$ SERVICES_VALUE                &lt;dbl&gt; 1075250, 13531, 2058393, 2556956, 112985…
$ SERVICES_TAX                  &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ EXPORTED_VALUE                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ EXPORTED_TAX                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ OUTPUT_TAX                    &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ INPUT_ADMISSIBLE              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0…
$ AVAILABLE_BALANCE             &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ ST_WITHHELD_BYRETURNFILER     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ TAX_REVERSE_CHARGED           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ CREDIT_CARRIED_FORWARD        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ BALANCE_TAX_PAYABLE           &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ TOTAL_AMOUNT_PAYABLE          &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ Date                          &lt;date&gt; 2019-07-01, 2019-08-01, 2019-09-01, 201…</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tax_df<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(tax)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tax_df&lt;-tax_df %&gt;% mutate(Year = str_replace_all(Year, pattern = ",", replacement = " "))</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">##tax_df$Date&lt;-as.Date(tax_df$Date)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tax_df$Date&lt;-as.Date(tax_df$Date)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>tax<span class="sc">$</span>Month<span class="ot">&lt;-</span>tax<span class="sc">$</span>TAX_PERIOD<span class="sc">-</span><span class="fu">round</span>(tax<span class="sc">$</span>TAX_PERIOD,<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>tax<span class="sc">$</span>Month<span class="ot">&lt;-</span>month.abb[tax<span class="sc">$</span>Month]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>tax<span class="sc">$</span>GST_RATE<span class="ot">&lt;-</span>tax <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">GST_RATE=</span>SERVICES_TAX<span class="sc">/</span>SERVICES_VALUE<span class="sc">*</span><span class="dv">100</span>,<span class="at">na.rm=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>tax_df<span class="ot">&lt;-</span>tax <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">'SCODE'</span>, <span class="st">'SERVICE'</span>,<span class="st">'Date'</span>,<span class="st">'TAX_PERIOD'</span>,<span class="st">'Year'</span>, <span class="st">'Month'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'PURCHASE_TAX'</span>,<span class="st">'PURCHASE_VALUE'</span>, <span class="st">'IMPORT_VALUE'</span>,<span class="st">'IMPORT_TAX'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'SERVICES_VALUE'</span>, <span class="st">'SERVICES_TAX'</span>,<span class="st">'OUTPUT_TAX'</span>, <span class="st">'GST_RATE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overall-tax" class="level1">
<h1>Overall Tax</h1>
<section id="overall-tax-summary" class="level2">
<h2 class="anchored" data-anchor-id="overall-tax-summary">Overall Tax Summary</h2>
<p>The <code>tax_summary</code> dataset provides a summary of the tax collected from around 178 services in Pakistani Rs. This data is for each fiscal year from 2012 to 2018. There are 1,033,223 observations with data on 28 variables. After some basic data operations, we present here a summary of <code>tax_output</code> which is tax on each service sector. This <code>yearly</code> data does not include <code>2022</code> as its full data are yet not available.</p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="monthly-tax-summary" class="level2">
<h2 class="anchored" data-anchor-id="monthly-tax-summary">Monthly tax summary</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/tax-monthly-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>::: notes There is sharp dip from early 2018 till 2019 in overall revenue from all services. Why there is a dip in <code>tax_output</code>, we shall explore this issue while doing separate analaysis for <code>Cellular Telephone</code> sector. This sector generated more than 31% total services tax in the given period, while its share in fiscal year 2020, 2021 and ongoing 2022 is around 29%. In 2018, tax on the sector was brought at par with other sector and this led to a fall in revenue and tax was again raised in 2019. :::</p>
</section>
<section id="forecasting-overall-tax_output" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-overall-tax_output">Forecasting overall tax_output</h2>
<p>There are more than 170 services and if one needs to forecast , it is better to use some statistical forecasting methods in simple possible way. There are several methods but most commonly used methods are - Naive Forecasting - Autoregressive Moving Average Models (ARIMA Models) - Exponential Smoothing Methods (ETS) and - Artificial Nueral Network (ANN) ## ARIMA models ARIMA models are one of the most useful. We shall apply all these four but results will be discussed mainly on the basis of ARIMA models. Monthly forecasting is more reliable as sufficient data are availbe but requirement is to provide annual forecasting for which we have around 10 observations. These 10 observations serve the purpose as per Hyndman book <strong>Forecasting : Principle and Practice</strong>. According to him</p>
<div class="notes">
<blockquote class="blockquote">
<p>Some textbooks provide rules-of-thumb giving minimum sample sizes for various time series models. These are misleading and unsubstantiated in theory or practice. Further, they ignore the underlying variability of the data and often overlook the number of parameters to be estimated as well. There is, for example, no justification whatever for the magic number of 30 often given as a minimum for ARIMA modelling. The only theoretical limit is that we need more observations than there are parameters in our forecasting model. However, in practice, we usually need substantially more observations than that.</p>
</blockquote>
</div>
<p>We are providing both monthly and annual forecast with the methods mentioned above.</p>
</section>
<section id="annual-forecasting" class="level2">
<h2 class="anchored" data-anchor-id="annual-forecasting">Annual Forecasting</h2>
<section id="naive-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="naive-forecasting">NAIVE Forecasting</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: Naive method

Model Information:
Call: forecast::naive(y = yearly_tax$tax_by_serv, h = 1) 

Residual sd: 17752696607.4666 

Error measures:
                      ME        RMSE         MAE      MPE     MAPE MASE
Training set 15740641248 17752696607 15740641248 18.75938 18.75938    1
                   ACF1
Training set -0.4398209

Forecasts:
   Point Forecast        Lo 80        Hi 80        Lo 95        Hi 95
11   162226104227 139475108097 184977100357 127431458248 197020750206</code></pre>
</div>
</div>
</section>
<section id="arima-models" class="level3">
<h3 class="anchored" data-anchor-id="arima-models">ARIMA models</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: yearly_tax$tax_by_serv 
ARIMA(2,1,0) 

Coefficients:
         ar1     ar2
      0.1843  0.7445
s.e.  0.2214  0.2291

sigma^2 = 1.099e+20:  log likelihood = -220.47
AIC=446.95   AICc=451.75   BIC=447.54

Training set error measures:
                     ME       RMSE        MAE      MPE     MAPE      MASE
Training set 1537049565 8772688798 7741780560 1.574306 9.316564 0.4918339
                   ACF1
Training set -0.2534413</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast        Lo 80        Hi 80        Lo 95        Hi 95
11   173683229675 160245689090 187120770261 153132284793 194234174558</code></pre>
</div>
</div>
</section>
<section id="aritificial-nueral-networks" class="level3">
<h3 class="anchored" data-anchor-id="aritificial-nueral-networks">Aritificial Nueral Networks</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast        Lo 80        Hi 80        Lo 95        Hi 95
11   188718760972 178994515343 195496113266 175082551275 199019867505
12   219412216293 204901622974 228539996912 196060413916 234514756093</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                    ME       RMSE        MAE        MPE     MAPE      MASE
Training set -872962.9 6987726201 6148145682 -0.4255406 5.942142 0.3905905
                  ACF1
Training set -0.681767</code></pre>
</div>
</div>
</section>
</section>
<section id="monthly-forecasting-for-total-tax-over-time" class="level2">
<h2 class="anchored" data-anchor-id="monthly-forecasting-for-total-tax-over-time">Monthly forecasting for total tax over time</h2>
<p>In this case data quite smooth except one dip which was due to Supreme Court decision to make cellular taxes the same as in other services. As monthly data are available and more granularity always helps to get better insight, therefore, forecasting with three methods : seasonal naive, arima and ANN is given below.<br>
### Seasonal Naive Forecasting</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95
115       15735.92 14660.59 16811.25 14091.347 17380.50
116       15735.92 14215.18 17256.67 13410.142 18061.70
117       15735.92 13873.40 17598.45 12887.434 18584.41
118       15735.92 13585.26 17886.58 12446.771 19025.07
119       15735.92 13331.41 18140.43 12058.540 19413.31
120       15735.92 13101.91 18369.93 11707.551 19764.29
121       15735.92 12890.87 18580.98 11384.784 20087.06
122       15735.92 12694.43 18777.42 11084.360 20387.49
123       15735.92 12509.93 18961.91 10802.195 20669.65
124       15735.92 12335.43 19136.42 10535.318 20936.53
125       15735.92 12169.46 19302.39 10281.482 21190.36
126       15735.92 12010.87 19460.98 10038.945 21432.90
127       15735.92 11858.76 19613.08  9806.320 21665.53
128       15735.92 11712.41 19759.44  9582.484 21889.36
129       15735.92 11571.19 19900.66  9366.508 22105.34
130       15735.92 11434.60 20037.24  9157.620 22314.23
131       15735.92 11302.22 20169.62  8955.163 22516.68
132       15735.92 11173.68 20298.16  8758.579 22713.27
133       15735.92 11048.67 20423.18  8567.383 22904.46
134       15735.92 10926.90 20544.95  8381.156 23090.69
135       15735.92 10808.14 20663.71  8199.530 23272.32
136       15735.92 10692.18 20779.67  8022.179 23449.67
137       15735.92 10578.82 20893.03  7848.814 23623.03
138       15735.92 10467.90 21003.94  7679.180 23792.67</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/forecasting-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="autoregressive-integrated-moving-average-models" class="level3">
<h3 class="anchored" data-anchor-id="autoregressive-integrated-moving-average-models">Autoregressive Integrated Moving Average Models</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: total_tax$tax_mill 
ARIMA(5,1,0) with drift 

Coefficients:
          ar1      ar2      ar3      ar4      ar5     drift
      -0.3775  -0.2435  -0.1356  -0.2932  -0.2041  102.9657
s.e.   0.0924   0.0956   0.0980   0.0958   0.0924   31.7615

sigma^2 = 594355:  log likelihood = -908.72
AIC=1831.44   AICc=1832.51   BIC=1850.53

Training set error measures:
                    ME     RMSE     MAE        MPE    MAPE      MASE       ACF1
Training set -1.442092 746.8999 541.894 -0.9719923 6.59591 0.8392275 0.04245388</code></pre>
</div>
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/forecasting-arima-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">

<table>
<caption>Forecast results from ARIMA model</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Point Forecast </th>
   <th style="text-align:right;"> Lo 80 </th>
   <th style="text-align:right;"> Hi 80 </th>
   <th style="text-align:right;"> Lo 95 </th>
   <th style="text-align:right;"> Hi 95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 115 </td>
   <td style="text-align:right;"> 15406.25 </td>
   <td style="text-align:right;"> 14389.39 </td>
   <td style="text-align:right;"> 16423.11 </td>
   <td style="text-align:right;"> 13851.10 </td>
   <td style="text-align:right;"> 16961.40 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 116 </td>
   <td style="text-align:right;"> 15512.74 </td>
   <td style="text-align:right;"> 14324.08 </td>
   <td style="text-align:right;"> 16701.40 </td>
   <td style="text-align:right;"> 13694.84 </td>
   <td style="text-align:right;"> 17330.63 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 117 </td>
   <td style="text-align:right;"> 15619.22 </td>
   <td style="text-align:right;"> 14280.63 </td>
   <td style="text-align:right;"> 16957.81 </td>
   <td style="text-align:right;"> 13572.03 </td>
   <td style="text-align:right;"> 17666.42 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 118 </td>
   <td style="text-align:right;"> 15725.71 </td>
   <td style="text-align:right;"> 14252.37 </td>
   <td style="text-align:right;"> 17199.05 </td>
   <td style="text-align:right;"> 13472.43 </td>
   <td style="text-align:right;"> 17978.99 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 119 </td>
   <td style="text-align:right;"> 15832.19 </td>
   <td style="text-align:right;"> 14235.43 </td>
   <td style="text-align:right;"> 17428.96 </td>
   <td style="text-align:right;"> 13390.16 </td>
   <td style="text-align:right;"> 18274.23 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 120 </td>
   <td style="text-align:right;"> 15938.68 </td>
   <td style="text-align:right;"> 14227.38 </td>
   <td style="text-align:right;"> 17649.98 </td>
   <td style="text-align:right;"> 13321.47 </td>
   <td style="text-align:right;"> 18555.89 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 121 </td>
   <td style="text-align:right;"> 16045.17 </td>
   <td style="text-align:right;"> 14226.52 </td>
   <td style="text-align:right;"> 17863.81 </td>
   <td style="text-align:right;"> 13263.79 </td>
   <td style="text-align:right;"> 18826.54 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 122 </td>
   <td style="text-align:right;"> 16151.65 </td>
   <td style="text-align:right;"> 14231.66 </td>
   <td style="text-align:right;"> 18071.65 </td>
   <td style="text-align:right;"> 13215.27 </td>
   <td style="text-align:right;"> 19088.03 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 123 </td>
   <td style="text-align:right;"> 16258.14 </td>
   <td style="text-align:right;"> 14241.88 </td>
   <td style="text-align:right;"> 18274.40 </td>
   <td style="text-align:right;"> 13174.54 </td>
   <td style="text-align:right;"> 19341.74 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 124 </td>
   <td style="text-align:right;"> 16364.62 </td>
   <td style="text-align:right;"> 14256.49 </td>
   <td style="text-align:right;"> 18472.75 </td>
   <td style="text-align:right;"> 13140.52 </td>
   <td style="text-align:right;"> 19588.73 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 125 </td>
   <td style="text-align:right;"> 16471.11 </td>
   <td style="text-align:right;"> 14274.95 </td>
   <td style="text-align:right;"> 18667.27 </td>
   <td style="text-align:right;"> 13112.37 </td>
   <td style="text-align:right;"> 19829.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 126 </td>
   <td style="text-align:right;"> 16577.60 </td>
   <td style="text-align:right;"> 14296.80 </td>
   <td style="text-align:right;"> 18858.39 </td>
   <td style="text-align:right;"> 13089.42 </td>
   <td style="text-align:right;"> 20065.77 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 127 </td>
   <td style="text-align:right;"> 16684.08 </td>
   <td style="text-align:right;"> 14321.68 </td>
   <td style="text-align:right;"> 19046.48 </td>
   <td style="text-align:right;"> 13071.10 </td>
   <td style="text-align:right;"> 20297.06 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 128 </td>
   <td style="text-align:right;"> 16790.57 </td>
   <td style="text-align:right;"> 14349.29 </td>
   <td style="text-align:right;"> 19231.85 </td>
   <td style="text-align:right;"> 13056.95 </td>
   <td style="text-align:right;"> 20524.19 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 129 </td>
   <td style="text-align:right;"> 16897.05 </td>
   <td style="text-align:right;"> 14379.36 </td>
   <td style="text-align:right;"> 19414.74 </td>
   <td style="text-align:right;"> 13046.58 </td>
   <td style="text-align:right;"> 20747.53 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 130 </td>
   <td style="text-align:right;"> 17003.54 </td>
   <td style="text-align:right;"> 14411.69 </td>
   <td style="text-align:right;"> 19595.39 </td>
   <td style="text-align:right;"> 13039.65 </td>
   <td style="text-align:right;"> 20967.43 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 131 </td>
   <td style="text-align:right;"> 17110.03 </td>
   <td style="text-align:right;"> 14446.08 </td>
   <td style="text-align:right;"> 19773.97 </td>
   <td style="text-align:right;"> 13035.88 </td>
   <td style="text-align:right;"> 21184.17 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 132 </td>
   <td style="text-align:right;"> 17216.51 </td>
   <td style="text-align:right;"> 14482.37 </td>
   <td style="text-align:right;"> 19950.65 </td>
   <td style="text-align:right;"> 13035.01 </td>
   <td style="text-align:right;"> 21398.01 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 133 </td>
   <td style="text-align:right;"> 17323.00 </td>
   <td style="text-align:right;"> 14520.42 </td>
   <td style="text-align:right;"> 20125.57 </td>
   <td style="text-align:right;"> 13036.83 </td>
   <td style="text-align:right;"> 21609.16 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 134 </td>
   <td style="text-align:right;"> 17429.48 </td>
   <td style="text-align:right;"> 14560.11 </td>
   <td style="text-align:right;"> 20298.86 </td>
   <td style="text-align:right;"> 13041.15 </td>
   <td style="text-align:right;"> 21817.82 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 135 </td>
   <td style="text-align:right;"> 17535.97 </td>
   <td style="text-align:right;"> 14601.31 </td>
   <td style="text-align:right;"> 20470.63 </td>
   <td style="text-align:right;"> 13047.79 </td>
   <td style="text-align:right;"> 22024.15 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 136 </td>
   <td style="text-align:right;"> 17642.45 </td>
   <td style="text-align:right;"> 14643.93 </td>
   <td style="text-align:right;"> 20640.98 </td>
   <td style="text-align:right;"> 13056.61 </td>
   <td style="text-align:right;"> 22228.30 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 137 </td>
   <td style="text-align:right;"> 17748.94 </td>
   <td style="text-align:right;"> 14687.88 </td>
   <td style="text-align:right;"> 20810.00 </td>
   <td style="text-align:right;"> 13067.46 </td>
   <td style="text-align:right;"> 22430.42 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 138 </td>
   <td style="text-align:right;"> 17855.43 </td>
   <td style="text-align:right;"> 14733.09 </td>
   <td style="text-align:right;"> 20977.76 </td>
   <td style="text-align:right;"> 13080.23 </td>
   <td style="text-align:right;"> 22630.63 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="artificial-nueral-network-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="artificial-nueral-network-forecasting">Artificial Nueral Network Forecasting</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast        Lo 80        Hi 80        Lo 95        Hi 95
11   188718760972 179800386295 196661348931 176159546480 204433544285
12   219412216293 207173653588 230919007926 199951907341 238725005059
13   249169889314 234292745876 259717928776 226512544666 263560755110
14   270990045867 257260720683 281531163483 250768998689 286744741949
15   282862434614 272078827270 293908468806 266415630213 299586334140
16   288054308246 277636483200 297033248333 272066449239 300527846159
17   290075956912 280799492369 298422936877 274532568157 308001691100
18   290824842680 282149199971 299956109016 274901211638 310246455851
19   291096958369 279226102774 299943658141 274702147395 306139432409
20   291195133198 280866990218 299917205603 276029262186 309027435260
21   291230461661 281165646692 300476032980 277725320523 303595285366
22   291243162860 282136544255 301439096463 277243143561 304697355004
23   291247727632 282516385897 302215798887 276777810897 306365224090
24   291249368000 282270317899 299557072683 277626241777 306171535002
25   291249957447 283336425599 299027416836 278208505123 303237568630
26   291250169254 284254813272 298972049532 278280636356 306577500678
27   291250245363 282161559963 301154149000 277046301441 306941087347
28   291250272711 281310450159 298170900022 276726614807 302419744501
29   291250282538 283238057915 300356412261 275053548418 303827604994
30   291250286069 281398357358 301343926904 278367846082 305909942673
31   291250287338 282247265371 300467604056 277036897466 302473436050
32   291250287794 281127522541 300425810028 273878195535 304795403191
33   291250287958 282449202421 300854412474 278059642752 306165398796
34   291250288016 283023184451 302169971230 276525493977 309341585357</code></pre>
</div>
<div class="cell-output-display">

<table>
<caption>Forecast accuracy using ANN</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> ME </th>
   <th style="text-align:right;"> RMSE </th>
   <th style="text-align:right;"> MAE </th>
   <th style="text-align:right;"> MPE </th>
   <th style="text-align:right;"> MAPE </th>
   <th style="text-align:right;"> MASE </th>
   <th style="text-align:right;"> ACF1 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Training set </td>
   <td style="text-align:right;"> 36.51 </td>
   <td style="text-align:right;"> 785.34 </td>
   <td style="text-align:right;"> 596.3 </td>
   <td style="text-align:right;"> -0.41 </td>
   <td style="text-align:right;"> 7.18 </td>
   <td style="text-align:right;"> 0.92 </td>
   <td style="text-align:right;"> -0.04 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="service-sector-share-in-total-tax-by-service-category" class="level2">
<h2 class="anchored" data-anchor-id="service-sector-share-in-total-tax-by-service-category">Service sector share in total tax by service category</h2>
<p>Top 10 sectors tax share is almost 65% .</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SCODE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(OUTPUT_TAX)/1e+06
1              916400.9</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `SCODE`</code></pre>
</div>
<div class="cell-output-display">

<div id="htmlwidget-f53e82139b465e7bc7ca" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f53e82139b465e7bc7ca">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1.1 The total tax for each service for the 2013 to 2022 fiscal years.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175"],["9812.121","9813.4","9809","9812.1","9824","9801.2","9804.2","9808","9815.5","9801.1","9812.199","9818.1","9804.9","9999","9805.6","9875","9813.11","9813.16","9823","9814.2","9815.6","9802.1","9819.13","9819.909","9805.92","9813",null,"9805.4","9838","9819.94","9820.1","9802.7","9822.2","9805.7","9802.5","9829","9815.4","9802.9","9815.9","9812.2","9822.9","9819.3","9805.3","9802.6","9813.12","9801.9","9807","9812.22","9845","9801.4","9822.3","9816","9852","9801.5","9868","9815.3","9813.1","9820.3","9814.1","9880","9826","9882","9801.3","9806.3","9833","9805.1","9819.1","9825","9876","9821.1","9859","9802.2","9812.949","9848","9827","9820.2","9828","9860","9873","9813.14","9818.9","9856","9820.9","9858","9812.122","9812.12","9849","9819.7","9810","9822.1","9805.5","9857","9814.9","9819.5","9812.11","9812.171","9818.2","9812.24","9819.6","9805.51","9841","9863","9805.9","9811","9802.4","9812.25","9805.2","9819.92","9834","9874","9818.3","9805.91","9819.14","9851","9806.2","9819.12","9821.2","9883","9812.5","9999.1111","9812.15","9832","9862","9803.1","9815.2","9837","9830","9865","9888","9819.9","9802.3","9884","9886","9872","9814.4","9855","9812.501","9850","9869","9861","9871","9819.95","9803.11","9847","9820.4","9812.14","9812.95","9839","9890","9803.9","9853","9812.17","9885","9844","9813.3","9815.1","9812.92","9815.7","9813.42","9889","9887","9819.91","9877","9812.23","9812.16","9812.172","9812.6","9812.93","9812.3","9822.4","9821.4","9812.612","9812.94","9812.941","9870"],["Cellular Telephone","Services provided by Banking Companies or Non-Banking Financial Institutions including but not limited to all non-interest based services provided against a consideration in form or a fee or commission or charge","Contractual execution of work or furnishing supplies.","Telephone Services","Construction services","Restaurants including cafes, food (including ice-cream) parlors, coffee houses, coffee shops, deras, food huts, eateries, resorts and similar cooked, prepared or ready-to-eat food service outlets etc.","Service provided by persons for inter-city carriage of goods by rail or road","Courier services","Technical scientific &amp; engineering consultant including technical inspection and certification servives,","Hotels","Others telecom Services","Security agency","Cargo service by road passenger transportation business and transportation through pipeline and conduit services","Other Services","Manpower recruitment agents including labour and manpower supplies.","Services in relation to transport of goods other than water, through pipeline, conduit or any other medium","Goods insurance","Other insurance","Franchise services","Contractor of building (including water supply, gas supply and sanitary works), electrical and machanical works (including air conditioning), multi-disciplinary works (including turn-key projects) and similar other works","Information Technology-enabled or Information Technology-based services","Advertisement on T.V","Commission agents","Services provided in respect of mining of minerals, oil &amp; gas including related surveys and allied activities.","Business support services","Banking companies, cooperative financing societies, modarabas, musharikas, leasing companies, non-banking financial institutions or other persons businesses or enterprises providing or dealing in any such services.","Withholding Agent","Customs Agents","Services Provided by Port Operators (Including Airports and Dry Ports) and Allied Services Provided At Ports and Services Provided By Terminal Operators Including Services In Respect of Public Bonded Warehouses","Technical analysis and testing, erection, commissioning and installation services","Auto-workshops","Advertisement on hoarding boards / bill boards","Maintenance or cleaning services","Advertising Agents","Advertisement on cable television","Brokerage (other than stock) and indenting services","Management consultants","Other advertisement including websites or internet","Other consultants","Bandwidth Services","Other similar services","Rent-a-car.","Freight forwarding agents","Advertisement on pole signs and sign boards","Fire insurance","Other restaurants services","Property developers and promoters (including allied services)","Fibre-Optic Based","Automobile dealers","Clubs","Janitorial services","Laboratories other than services relating to pathological or diagnostic tests for patients.","Human resource &amp; Personnel development","Caterers","Toll Manufacturing (against processing charges) including industrail and similar outsourcing of industrial or commercial processes.","Accountant and auditors","Insurance to a policy holder by an insurer, including a reinsurer.","Workshops for electric or electronic equipments or appliances, etc., including computer hardware","Architects or town planners","Supply chain management or distribution (including delivery) services","Management services including fund and assets mangement services","Marketing or Sales Services","Marriage halls and lawns","Car dealers.","Services provided by warehouses or depots for storage including cold storages.","Shipping agents","Stock brokers","Consultancy services","Services in relation to supply of tangible goods including machinery, equipment and appliances for use, without transferring right of possession and effective control of such machinery, equipment and appliances.","Healthcare centre, gyms or physical fitness center, etc","Human resource development","Advertisement on radio","Vehicle Tracking System","Beauty parlors and beauty clinics","Market research agency","Workshops for industrial machinery, construction and earth-moving machinery or other special purpose machinery, etc.","TV or radio program producers or production houses","Building maintenance and service provider","Event Management Services","Marine insurance","Other such agencies","Training services","Other workshops","Security alarrm services","Wireless Local Loop Telephone","Wireless Telephone","HR consultants","Services provided by photography studios and event or occasion photographers/film makers","Personal care by slimming clinics and others","Fumigation services","Travel Agents","Tracking services","Interior Decorators and interior designers","Surveyors","Fixed Line Voice Telephone Service","Short Message Service (SMS)","Credit rating agency","Microwave Based","Designers","Tour operators including all their allied services or facilities (other than Hajj and Umrah)","Packaging services","Debt collection and similar other recovery services.","Share transfer or depository agents including services provided through manual or electronic book-entry system used to record and maintain securities and to register the transfer of shares securities and derivatives.","Laundries and dry cleaners","Advertisement in newspapers magazines, journals and periodicals.","Satellite Based","Stevedores","Public  relation services","Fashion designers","Visa processing services","Market research agency","Sponsorship services","Services provided by Packers including handling services.","Tax Consultants","Property dealers","Indenters","Indoor sports and games center and amusement parks, arcades and other recreation facilities","Certification Services","Telefax","Ride Hailing Services","Prepaid Calling Cards","Exhibition or convention services","Motels and guest houses","Travel by air of passengers within the territorial jurisdiction of Pakistan","Legal Practitioners and consultants","Pandal &amp; Shamiana Services","Race clubs","Call centres","Rental of bulldozers, Excavators, Cranes, Construction equipment, Scaffolding, Generators, Storage containers, Refrigerator, Shelf or Rack renting, etc","Cable TV operators","Advertisement on closed circuit T.V","Verification and equivalence services","Parking Services","Valuation Services","Landscape designers","Actuarial Services","Store and Forward Fax Services","Corporate Law Consultant","Floral or other decoration services","Quality control services","Evaluation Services (Including competency and eligibility testing services)","Service provided by a registrar to an issue","Facilities for travel originating from Punjab by Air for domestic and international travel. EXCULDING: Air travels services provided to Hajj or Umrah passengers, diplomats and supernumerary crew.","Cosmetic and plastic surgery","Car washing or similar service stations.","Payphone Cards","Burglar Alarm Services","Intellectual property services","Apartment house management, Real estate management and services of rent collection","Chartered flight services within or originating from the Punjab","Coaching centers","Messaging Service","Services provided hair transplant services but: EXCLUDING:Services provided to acid or burn victims.","Realtors","Leasing Companies","Medical consultation/ visit fee exceeding Rs. 1,500 per consultation/ visit of doctors, medical practitioners and medical specialists. (ii) Bed/ room charges of hospitals exceeding Rs. 6,000/- per day per bed/ room","Trunk Radio Services","Cosmetic and plastic surgery services","Brokerage","Services in respect of treatment of textile, Leather but not limited to Dyeing services, Edging and cutting, Cloth treating, Water proofing, Embroidery, Engraving, Fabric bleaching, Knitting, Leather staining, Leather working, Pre-shrinking, Color separation services, Pattern printing and shoe making services","Dress designing and Stitching Services","Auctioneers","Receivers","Coaxial cable Based","Voice Mail Service","Multimedia Message Service (MMS)","Internet Services","Paging Services","Telegraph","Dredging or desiliting services","Body massage center","Broadband Services","Voice Paging Services","Radio Paging Services","Furnishing of space whether or not involving rental of equipments and accessories for events"],[288739.42,58452.51,43442.76,42893.16,33542.57,31290.28,27936.25,25436.1,24725.21,23946.7,22227.97,21877.57,18457.36,17241.83,17010.62,14013.85,12183.27,11159.33,10609.11,9792.22,9585.17,9319.83,7590.53,7582.17,6953.08,5750.69,5117.7,4892.82,4330.89,4140.68,3699.98,3666.9,3581.66,3462.75,3304.33,3150.49,3103.19,3094.56,2876.62,2842.25,2840.86,2657.83,2576.57,2556.77,2545.06,2373.82,2338.01,2304.17,2230.39,2218.6,2190.86,2071.52,2070.77,1994.17,1759.64,1651.27,1633.59,1245.81,1144.68,1132.57,1079.92,1065.15,1060.73,1007.55,937.67,936.59,906.11,836.41,797.75,675.24,574.98,574.96,567.45,550.05,518.61,451.84,432.04,405.29,404.8,399.32,395.09,383.94,378.49,371.72,350.74,350.42,333.26,305.21,296.01,233.95,222.84,221.22,190.42,166.38,145.48,143.16,137.76,137.63,134.47,130.4,122.44,121.82,114.4,108.08,108.04,92.97,91.35,91.07,89.03,82.89,78.16,77.74,72.91,72.7,69.68,69.12,67.43,61.98,61.59,60.78,58.02,56.84,52.91,44.87,44.04,40.4,39.99,39.18,37.64,34.33,33.97,26.85,26.62,26.41,25.3,24.78,24.77,23.14,22.05,20.72,20.33,16.2,16.07,15.81,15.47,14.67,12.81,12.22,12.1,11.97,11.45,10.57,9.91,8.74,4.17,3.64,3.22,2.41,1.8,1.78,1.69,1.36,1.36,0.64,0.46,0.3,0.13,0.09,0.08,0.04,0.01,0,0,0,0],[31.51,6.38,4.74,4.68,3.66,3.41,3.05,2.78,2.7,2.61,2.43,2.39,2.01,1.88,1.86,1.53,1.33,1.22,1.16,1.07,1.05,1.02,0.83,0.83,0.76,0.63,0.56,0.53,0.47,0.45,0.4,0.4,0.39,0.38,0.36,0.34,0.34,0.34,0.31,0.31,0.31,0.29,0.28,0.28,0.28,0.26,0.26,0.25,0.24,0.24,0.24,0.23,0.23,0.22,0.19,0.18,0.18,0.14,0.12,0.12,0.12,0.12,0.12,0.11,0.1,0.1,0.1,0.09,0.09,0.07,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.03,0.03,0.03,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SCODE<\/th>\n      <th>SERVICE<\/th>\n      <th>Rs_millions<\/th>\n      <th>percent_share<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.52</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>tax_2020<span class="ot">&lt;-</span>tax_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Year<span class="sc">==</span><span class="dv">2020</span><span class="sc">|</span>Year<span class="sc">==</span><span class="dv">2021</span><span class="sc">|</span>Year<span class="sc">==</span><span class="dv">2022</span>) <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(SCODE,SERVICE) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">sum</span>(OUTPUT_TAX)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Rs_millions=</span><span class="fu">round</span>(total<span class="sc">/</span><span class="dv">1000000</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Rs_millions))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>total_output_tax_2020<span class="ot">&lt;-</span>tax_df <span class="sc">%&gt;%</span><span class="fu">filter</span>(Year<span class="sc">==</span><span class="dv">2020</span><span class="sc">|</span>Year<span class="sc">==</span><span class="dv">2021</span><span class="sc">|</span>Year<span class="sc">==</span><span class="dv">2022</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(OUTPUT_TAX)<span class="sc">/</span><span class="dv">1000000</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(total_output_tax_2020,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(OUTPUT_TAX)/1e+06
1              366567.6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tax_20_grp<span class="ot">&lt;-</span>tax_2020 <span class="sc">%&gt;%</span> <span class="fu">select</span>( SERVICE, Rs_millions) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">percent_share=</span><span class="fu">round</span>(Rs_millions<span class="sc">/</span><span class="fl">366567.6</span>  <span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(tax_20_grp, <span class="at">caption =</span><span class="st">"Table 1.2 The total tax for each service for the 2020 to 2022 fiscal years."</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-a520132034c7686e0a38" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a520132034c7686e0a38">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1.2 The total tax for each service for the 2020 to 2022 fiscal years.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174"],["9812.121","9813.4","9812.1","9804.2","9809","9824","9812.199","9808","9801.2","9815.5","9999","9818.1","9804.9","9805.6","9875","9801.1","9813.16","9814.2","9813.11","9823","9815.6","9805.92","9819.13","9819.94","9813","9802.1","9819.909",null,"9805.4","9812.2","9822.9","9838","9805.7","9829","9820.1","9802.9","9822.2","9805.3","9815.4","9815.9","9812.22","9813.1","9822.3","9801.9","9819.3","9815.3","9802.7","9816","9813.12","9801.4","9852","9802.5","9845","9807","9802.6","9868","9880","9820.3","9826","9801.5","9833","9882","9806.3","9814.1","9825","9801.3","9805.1","9876","9812.949","9819.1","9818.9","9820.2","9859","9848","9821.1","9860","9820.9","9819.7","9849","9856","9873","9813.14","9858","9827","9828","9802.2","9812.12","9805.5","9812.171","9814.9","9822.1","9863","9812.11","9819.5","9810","9999.1111","9874","9805.9","9818.2","9805.51","9812.24","9812.25","9851","9811","9857","9805.91","9818.3","9819.92","9819.12","9888","9841","9802.4","9806.2","9819.14","9834","9812.5","9805.2","9803.1","9883","9819.9","9815.2","9865","9886","9812.122","9821.2","9812.15","9837","9819.6","9830","9872","9812.501","9850","9820.4","9890","9814.4","9862","9812.14","9855","9869","9832","9885","9847","9861","9884","9819.95","9812.17","9871","9803.11","9803.9","9853","9844","9839","9815.1","9813.3","9812.95","9813.42","9889","9815.7","9887","9819.91","9812.23","9802.3","9812.92","9812.6","9877","9812.3","9822.4","9812.16","9812.172","9812.612","9812.93","9812.94","9821.4","9870"],["Cellular Telephone","Services provided by Banking Companies or Non-Banking Financial Institutions including but not limited to all non-interest based services provided against a consideration in form or a fee or commission or charge","Telephone Services","Service provided by persons for inter-city carriage of goods by rail or road","Contractual execution of work or furnishing supplies.","Construction services","Others telecom Services","Courier services","Restaurants including cafes, food (including ice-cream) parlors, coffee houses, coffee shops, deras, food huts, eateries, resorts and similar cooked, prepared or ready-to-eat food service outlets etc.","Technical scientific &amp; engineering consultant including technical inspection and certification servives,","Other Services","Security agency","Cargo service by road passenger transportation business and transportation through pipeline and conduit services","Manpower recruitment agents including labour and manpower supplies.","Services in relation to transport of goods other than water, through pipeline, conduit or any other medium","Hotels","Other insurance","Contractor of building (including water supply, gas supply and sanitary works), electrical and machanical works (including air conditioning), multi-disciplinary works (including turn-key projects) and similar other works","Goods insurance","Franchise services","Information Technology-enabled or Information Technology-based services","Business support services","Commission agents","Technical analysis and testing, erection, commissioning and installation services","Banking companies, cooperative financing societies, modarabas, musharikas, leasing companies, non-banking financial institutions or other persons businesses or enterprises providing or dealing in any such services.","Advertisement on T.V","Services provided in respect of mining of minerals, oil &amp; gas including related surveys and allied activities.","Withholding Agent","Customs Agents","Bandwidth Services","Other similar services","Services Provided by Port Operators (Including Airports and Dry Ports) and Allied Services Provided At Ports and Services Provided By Terminal Operators Including Services In Respect of Public Bonded Warehouses","Advertising Agents","Brokerage (other than stock) and indenting services","Auto-workshops","Other advertisement including websites or internet","Maintenance or cleaning services","Freight forwarding agents","Management consultants","Other consultants","Fibre-Optic Based","Insurance to a policy holder by an insurer, including a reinsurer.","Janitorial services","Other restaurants services","Rent-a-car.","Accountant and auditors","Advertisement on hoarding boards / bill boards","Laboratories other than services relating to pathological or diagnostic tests for patients.","Fire insurance","Clubs","Human resource &amp; Personnel development","Advertisement on cable television","Automobile dealers","Property developers and promoters (including allied services)","Advertisement on pole signs and sign boards","Toll Manufacturing (against processing charges) including industrail and similar outsourcing of industrial or commercial processes.","Supply chain management or distribution (including delivery) services","Workshops for electric or electronic equipments or appliances, etc., including computer hardware","Management services including fund and assets mangement services","Caterers","Services provided by warehouses or depots for storage including cold storages.","Marketing or Sales Services","Car dealers.","Architects or town planners","Consultancy services","Marriage halls and lawns","Shipping agents","Services in relation to supply of tangible goods including machinery, equipment and appliances for use, without transferring right of possession and effective control of such machinery, equipment and appliances.","Vehicle Tracking System","Stock brokers","Other such agencies","Workshops for industrial machinery, construction and earth-moving machinery or other special purpose machinery, etc.","Human resource development","Beauty parlors and beauty clinics","Healthcare centre, gyms or physical fitness center, etc","Building maintenance and service provider","Other workshops","Services provided by photography studios and event or occasion photographers/film makers","HR consultants","Training services","Event Management Services","Marine insurance","Security alarrm services","Market research agency","TV or radio program producers or production houses","Advertisement on radio","Wireless Telephone","Travel Agents","Short Message Service (SMS)","Interior Decorators and interior designers","Fumigation services","Debt collection and similar other recovery services.","Fixed Line Voice Telephone Service","Surveyors","Personal care by slimming clinics and others","Ride Hailing Services","Visa processing services","Share transfer or depository agents including services provided through manual or electronic book-entry system used to record and maintain securities and to register the transfer of shares securities and derivatives.","Credit rating agency","Tour operators including all their allied services or facilities (other than Hajj and Umrah)","Microwave Based","Satellite Based","Tax Consultants","Laundries and dry cleaners","Tracking services","Sponsorship services","Market research agency","Public  relation services","Indenters","Rental of bulldozers, Excavators, Cranes, Construction equipment, Scaffolding, Generators, Storage containers, Refrigerator, Shelf or Rack renting, etc","Packaging services","Advertisement in newspapers magazines, journals and periodicals.","Property dealers","Services provided by Packers including handling services.","Fashion designers","Telefax","Stevedores","Travel by air of passengers within the territorial jurisdiction of Pakistan","Certification Services","Cable TV operators","Legal Practitioners and consultants","Call centres","Parking Services","Wireless Local Loop Telephone","Indoor sports and games center and amusement parks, arcades and other recreation facilities","Prepaid Calling Cards","Pandal &amp; Shamiana Services","Designers","Race clubs","Valuation Services","Store and Forward Fax Services","Corporate Law Consultant","Car washing or similar service stations.","Apartment house management, Real estate management and services of rent collection","Landscape designers","Motels and guest houses","Payphone Cards","Actuarial Services","Floral or other decoration services","Exhibition or convention services","Services provided hair transplant services but: EXCLUDING:Services provided to acid or burn victims.","Cosmetic and plastic surgery","Quality control services","Verification and equivalence services","Service provided by a registrar to an issue","Messaging Service","Evaluation Services (Including competency and eligibility testing services)","Facilities for travel originating from Punjab by Air for domestic and international travel. EXCULDING: Air travels services provided to Hajj or Umrah passengers, diplomats and supernumerary crew.","Chartered flight services within or originating from the Punjab","Coaching centers","Realtors","Intellectual property services","Medical consultation/ visit fee exceeding Rs. 1,500 per consultation/ visit of doctors, medical practitioners and medical specialists. (ii) Bed/ room charges of hospitals exceeding Rs. 6,000/- per day per bed/ room","Leasing Companies","Burglar Alarm Services","Brokerage","Services in respect of treatment of textile, Leather but not limited to Dyeing services, Edging and cutting, Cloth treating, Water proofing, Embroidery, Engraving, Fabric bleaching, Knitting, Leather staining, Leather working, Pre-shrinking, Color separation services, Pattern printing and shoe making services","Cosmetic and plastic surgery services","Dress designing and Stitching Services","Auctioneers","Coaxial cable Based","Advertisement on closed circuit T.V","Trunk Radio Services","Internet Services","Receivers","Telegraph","Dredging or desiliting services","Voice Mail Service","Multimedia Message Service (MMS)","Broadband Services","Paging Services","Voice Paging Services","Body massage center","Furnishing of space whether or not involving rental of equipments and accessories for events"],[105442.14,21436.9,17403.21,16670.91,14979.96,13538.22,12724.1,12697.95,11452.11,10612.42,8660.67,8536.15,8102.22,7622.75,7087.54,6122.6,4849.8,4274.02,4254.76,4035.07,3470.92,3261.84,3242.6,2607.75,2529.03,2222.28,2127.96,1968.1,1806.8,1759.5,1630.22,1609.33,1556.99,1533.42,1502.41,1498.56,1374.09,1333.49,1305.17,1183.45,1163.09,1160.03,1096.85,992.56,976.58,934.39,928.14,919.46,919.15,891.96,864.5,847.21,824.48,741.36,700.9,668.48,666.53,653.23,629.8,617.32,547.88,546.65,475.14,431.53,418.84,372.24,359.42,333.16,278.72,271.14,261.32,250.67,243.17,234,216.64,190.1,186.6,170.58,167.32,160.44,159.98,156.19,155.98,148.77,128.3,122.48,118.75,116.42,114.41,108.19,100.94,85.58,78.91,76.48,72.54,60.78,60.32,59.41,54.71,54.14,53.92,52.69,50.9,49.15,46.64,44.51,44.23,42.89,41.49,37.64,36.59,35.73,34.22,33.21,31.52,30.85,30.76,30.64,29.79,26.67,24.87,24.6,21.21,19.66,19.28,18.04,17.7,16.8,15.76,15.29,14.78,12.46,12.27,12.1,11.84,11.37,11.05,11.03,10.99,9.83,9.17,9.11,9.07,8.71,8.28,7.23,6.22,6.03,5.4,4.94,4.75,3.89,3.64,2.3,2.13,1.8,1.78,1.69,1.69,0.95,0.64,0.26,0.23,0.13,0.12,0.08,0.04,0.03,0,0,0,0,0,0],[28.76,5.85,4.75,4.55,4.09,3.69,3.47,3.46,3.12,2.9,2.36,2.33,2.21,2.08,1.93,1.67,1.32,1.17,1.16,1.1,0.95,0.89,0.88,0.71,0.69,0.61,0.58,0.54,0.49,0.48,0.44,0.44,0.42,0.42,0.41,0.41,0.37,0.36,0.36,0.32,0.32,0.32,0.3,0.27,0.27,0.25,0.25,0.25,0.25,0.24,0.24,0.23,0.22,0.2,0.19,0.18,0.18,0.18,0.17,0.17,0.15,0.15,0.13,0.12,0.11,0.1,0.1,0.09,0.08,0.07,0.07,0.07,0.07,0.06,0.06,0.05,0.05,0.05,0.05,0.04,0.04,0.04,0.04,0.04,0.04,0.03,0.03,0.03,0.03,0.03,0.03,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SCODE<\/th>\n      <th>SERVICE<\/th>\n      <th>Rs_millions<\/th>\n      <th>percent_share<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="top-15-sector-during-fy-2020-22-as-per-tax_output" class="level2">
<h2 class="anchored" data-anchor-id="top-15-sector-during-fy-2020-22-as-per-tax_output">Top 15 sector during FY 2020-22 as per Tax_output</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>top<span class="ot">&lt;-</span> tax_20_grp <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(percent_share)) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>top10<span class="ot">&lt;-</span>top[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,] </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(top10, <span class="at">caption=</span><span class="st">"Top 10 services by tax output"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-383028e8fe1862ba4e7b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-383028e8fe1862ba4e7b">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top 10 services by tax output<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10"],["9812.121","9813.4","9812.1","9804.2","9809","9824","9812.199","9808","9801.2","9815.5"],["Cellular Telephone","Services provided by Banking Companies or Non-Banking Financial Institutions including but not limited to all non-interest based services provided against a consideration in form or a fee or commission or charge","Telephone Services","Service provided by persons for inter-city carriage of goods by rail or road","Contractual execution of work or furnishing supplies.","Construction services","Others telecom Services","Courier services","Restaurants including cafes, food (including ice-cream) parlors, coffee houses, coffee shops, deras, food huts, eateries, resorts and similar cooked, prepared or ready-to-eat food service outlets etc.","Technical scientific &amp; engineering consultant including technical inspection and certification servives,"],[105442.14,21436.9,17403.21,16670.91,14979.96,13538.22,12724.1,12697.95,11452.11,10612.42],[28.76,5.85,4.75,4.55,4.09,3.69,3.47,3.46,3.12,2.9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SCODE<\/th>\n      <th>SERVICE<\/th>\n      <th>Rs_millions<\/th>\n      <th>percent_share<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10, <span class="fu">aes</span>( <span class="at">x=</span>SCODE,<span class="at">y=</span>percent_share))<span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(top10<span class="sc">$</span>percent_share)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.64</code></pre>
</div>
</div>
<p>This indicates that 65% of tax share is from 10 services while remaining 35% is from remaining almost 166 services .</p>
</section>
<section id="forecasting-for-service-having-tax-rate-16" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-for-service-having-tax-rate-16">Forecasting for Service having Tax rate 16%</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tax_rate<span class="ot">&lt;-</span>tax <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SERVICES_VALUE<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate=</span>SERVICES_TAX<span class="sc">/</span>SERVICES_VALUE<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>tax_at_16<span class="ot">&lt;-</span>tax_rate <span class="sc">%&gt;%</span> <span class="fu">filter</span>( rate<span class="sc">==</span><span class="dv">16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">sum</span>(SERVICES_TAX)) </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>tax_at_16 <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(tax_at_16<span class="sc">$</span>total))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(tax_at_16$total)
1          38529336708</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tax_at_all<span class="ot">&lt;-</span>tax_rate  <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">sum</span>(SERVICES_TAX)) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>tax_at_all <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(tax_at_all<span class="sc">$</span>total))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(tax_at_all$total)
1          914149597553</code></pre>
</div>
</div>
<section id="tax-forecast-for-services-having-16-tax-rate" class="level3">
<h3 class="anchored" data-anchor-id="tax-forecast-for-services-having-16-tax-rate">Tax forecast for services having 16% tax-rate</h3>
<p>Top 10 sectors with maximum tax collection with 16% rates applied are as follows.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tax_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 844,840
Columns: 30
$ `Tax Payer`                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2…
$ SCODE                         &lt;chr&gt; "9815.6", "9815.6", "9815.6", "9815.6", …
$ SERVICE                       &lt;chr&gt; "Information Technology-enabled or Infor…
$ TAX_PERIOD                    &lt;dbl&gt; 201907, 201908, 201909, 201910, 201911, …
$ Year                          &lt;dbl&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020…
$ PURCHASE_VALUE                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ PURCHASE_TAX                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ IMPORT_VALUE                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ IMPORT_TAX                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ NON_CREDITABLE_TAX            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ CARRY_FORWARD_PREVIOUS_MONTHS &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ SALES_TAX_WHT                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ INPUT_TAX                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ ACCUMULATED_CREDIT            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0…
$ SERVICES_VALUE                &lt;dbl&gt; 1075250, 13531, 2058393, 2556956, 112985…
$ SERVICES_TAX                  &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ EXPORTED_VALUE                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ EXPORTED_TAX                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ OUTPUT_TAX                    &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ INPUT_ADMISSIBLE              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0…
$ AVAILABLE_BALANCE             &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ ST_WITHHELD_BYRETURNFILER     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ TAX_REVERSE_CHARGED           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ CREDIT_CARRIED_FORWARD        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ BALANCE_TAX_PAYABLE           &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ TOTAL_AMOUNT_PAYABLE          &lt;dbl&gt; 172040, 2165, 329343, 409113, 1807770, 2…
$ Date                          &lt;date&gt; 2019-07-01, 2019-08-01, 2019-09-01, 201…
$ Month                         &lt;chr&gt; "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"…
$ GST_RATE                      &lt;data.table[,30]&gt; &lt;data.table[26 x 30]&gt;
$ rate                          &lt;dbl&gt; 16.00000, 16.00030, 16.00001…</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tax_rate <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SCODE)<span class="sc">%&gt;%</span> <span class="fu">filter</span>( rate<span class="sc">==</span><span class="dv">16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">sum</span>(SERVICES_TAX)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(total)) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   SCODE       total
   &lt;chr&gt;       &lt;dbl&gt;
 1 9813.4 5470143100
 2 9809   2294369416
 3 9801.2 2183163468
 4 9824   1958740460
 5 9815.5 1837223020
 6 9818.1 1546930952
 7 9805.6 1242568456
 8 9875   1085988316
 9 9808    975380512
10 9999    975096860</code></pre>
</div>
</div>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tax_rate_yr<span class="ot">&lt;-</span>tax_rate <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rate<span class="sc">==</span><span class="dv">16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tax_val=</span><span class="fu">sum</span>(SERVICES_TAX)) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Extract year variable from Date</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>tax_rate_yr<span class="sc">$</span>year<span class="ot">&lt;-</span><span class="fu">year</span>(tax_rate_yr<span class="sc">$</span>Date)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>tax_rate_yr<span class="ot">&lt;-</span>tax_rate_yr<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tax_by_serv=</span><span class="fu">sum</span>(tax_val))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>tax_rate_yr<span class="ot">&lt;-</span>tax_rate_yr <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">!=</span><span class="dv">2022</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#tax_year1&lt;-ts(tax_year$tax_by_serv,  frequency = 1,start = c(2013,1))</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tax_year1)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tax_rate_yr,<span class="fu">aes</span>(year, tax_by_serv))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total tax collected from services sector over 2013-2021"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fiscal Year"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rs"</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(tax_rate_yr<span class="sc">$</span>tax_by_serv, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast      Lo 80      Hi 80      Lo 95      Hi 95
11     6050069360 5241876368 6858262352 4814044842 7286093878</code></pre>
</div>
</div>
<p>So <strong>Rs. 60.5</strong> billion rupees tax will be collected from sectors where 16% tax rate is appplied. If tax rate is reduced by 1%, it will reduce tax collection by <strong>Rs. 378</strong> million in a year. Now we calculate impact of loss in revenue if tax is reduced by 1% in top 10 sectors having tax rate of 16%.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>top10_tax<span class="ot">&lt;-</span>tax_rate <span class="sc">%&gt;%</span> <span class="fu">select</span>(SCODE, SERVICE, SERVICES_VALUE, SERVICES_TAX,Date, Year,rate) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( SCODE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"9813.4"</span>,<span class="st">"9801.2"</span>,<span class="st">"9809"</span>,<span class="st">"9815.5"</span>,<span class="st">"9824"</span>,<span class="st">"9805.6"</span>,<span class="st">"9999"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"9875"</span>,<span class="st">"9818.1"</span>,<span class="st">"9813"</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>top_10<span class="ot">&lt;-</span>  top10_tax <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SCODE,Date)<span class="sc">%&gt;%</span> <span class="fu">filter</span>(rate<span class="sc">==</span><span class="dv">16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">sum</span>(SERVICES_TAX)) </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>top_10<span class="sc">$</span>year<span class="ot">&lt;-</span><span class="fu">year</span>(top_10<span class="sc">$</span>Date)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>top_10_yr<span class="ot">&lt;-</span>top_10<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tax_by_serv=</span><span class="fu">sum</span>(total))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Total tax by top 10 companies at 16% rate</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>top_10_yr <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(tax_by_serv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `sum(tax_by_serv)`
               &lt;dbl&gt;
1        19043985392</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>tax_rate_yr<span class="ot">&lt;-</span>tax_rate_yr <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">!=</span><span class="dv">2022</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_10_yr,<span class="fu">aes</span>(year, tax_by_serv))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total tax collected from top 10 services sector over 2013-2021"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fiscal Year"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rs "</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span><span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="total-tax-output_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(top_10_yr<span class="sc">$</span>tax_by_serv, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast      Lo 80      Hi 80      Lo 95      Hi 95
11     3166916756 2696614408 3637219105 2447651383 3886182130</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>